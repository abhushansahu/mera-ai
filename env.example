# =============================================================================
# Mera AI - Environment Configuration
# =============================================================================
#
# This file contains all environment variables used by the Mera AI application.
# Copy this file to .env and fill in your actual values:
#
#   cp env.example .env
#   # Then edit .env with your actual API keys and configuration
#
# IMPORTANT: This configuration assumes self-hosted services (PostgreSQL, Mem0, Langfuse)
# Start self-hosted services with: docker-compose up -d
#
# =============================================================================
# REQUIRED CONFIGURATION - Application will NOT start without these
# =============================================================================

# -----------------------------------------------------------------------------
# OpenRouter API Configuration (External Service)
# -----------------------------------------------------------------------------
# OpenRouter provides access to multiple LLM models through a single API.
# Get your API key at: https://openrouter.ai/
# Required: YES - Application will fail to start without this

OPENROUTER_API_KEY=your_openrouter_api_key_here

# OpenRouter Base URL
# Default: https://openrouter.ai/api/v1
# Only change this if using a custom OpenRouter endpoint
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1

# Default LLM Model
# Default: openai/gpt-4o-mini
# This model will be used when no specific model is requested
# See available models at: https://openrouter.ai/models
DEFAULT_MODEL=openai/gpt-4o-mini


# -----------------------------------------------------------------------------
# Database Configuration (Self-Hosted PostgreSQL)
# -----------------------------------------------------------------------------
# PostgreSQL database connection string for the main application database.
# The database is self-hosted via Docker Compose.
# Required: YES - Application will fail to start without this
#
# Format: postgresql+psycopg2://user:password@host:port/database
# Default values match docker-compose.yml configuration

DATABASE_URL=postgresql+psycopg2://ai_user:ai_password@localhost:5432/ai_assistant


# -----------------------------------------------------------------------------
# Mem0 Memory Service Configuration
# -----------------------------------------------------------------------------
# Mem0 provides persistent memory for the AI assistant.
# You can use either self-hosted (recommended) or external Mem0.
# Required: YES - MEM0_HOST must be set for self-hosted (recommended)
# MEM0_API_KEY is only required if using external Mem0 service

# Option 1: Self-Hosted Mem0 (Recommended)
# Mem0 runs as a Docker container via docker-compose.yml
# Default host: http://localhost:8001
# Note: MEM0_API_KEY is NOT required for self-hosted Mem0
# The self-hosted server doesn't validate API keys
MEM0_HOST=http://localhost:8001
# MEM0_API_KEY is optional for self-hosted - leave it unset or use any placeholder value

# Option 2: External Mem0 (Alternative)
# If you prefer to use external Mem0 service instead of self-hosted:
# 1. Comment out MEM0_HOST above
# 2. Uncomment and set MEM0_API_KEY below with your external Mem0 API key
# 3. Get your key at: https://mem0.ai/
# MEM0_API_KEY=your_external_mem0_api_key_here

# Option 3: Chroma (Alternative to Mem0)
# If you prefer to use Chroma instead of Mem0:
# 1. Set USE_CHROMA=true
# 2. Optionally set CHROMA_HOST and CHROMA_PORT for client-server mode
# 3. Or leave them unset to use embedded mode (default)
# USE_CHROMA=false
# CHROMA_HOST=
# CHROMA_PORT=8000
# CHROMA_COLLECTION_NAME=memories
# CHROMA_PERSIST_DIR=./chroma_db


# =============================================================================
# OPTIONAL CONFIGURATION - Application will run without these
# =============================================================================

# -----------------------------------------------------------------------------
# Langfuse Observability (Self-Hosted)
# -----------------------------------------------------------------------------
# Langfuse provides observability, tracing, and monitoring for LLM applications.
# The service is self-hosted via Docker Compose.
# Optional: Application will run without Langfuse, but observability will be disabled
#
# Setup Instructions:
# 1. Start Docker services: docker-compose up -d
# 2. Access Langfuse UI at: http://localhost:3000
# 3. Create an account in the web UI
# 4. Go to Settings â†’ API Keys to get your keys
# 5. Copy the public and secret keys below

# Langfuse Host URL
# Default: http://localhost:3000
# Only change if running Langfuse on a different host/port
LANGFUSE_HOST=http://localhost:3000

# Langfuse API Keys
# Get these from the Langfuse web UI after creating an account
# Leave empty if you don't want to use Langfuse observability
LANGFUSE_PUBLIC_KEY=
LANGFUSE_SECRET_KEY=

# Note: The following environment variables are automatically set by the application
# to prevent ZodError validation issues (GitHub #7995). You don't need to set them:
# - NEXT_PUBLIC_API_URL (set automatically to match LANGFUSE_HOST)
# - NEXT_RUNTIME (set automatically to "nodejs" as dummy value)
# - NODE_ENV (set automatically to "production" as dummy value)
# These are required by Langfuse's internal validation but not used by our Python app.


# -----------------------------------------------------------------------------
# Obsidian Integration (External/Local Application)
# -----------------------------------------------------------------------------
# Obsidian provides a knowledge vault for storing and retrieving context.
# Obsidian runs locally on your machine (not in Docker).
# Optional: Application will run without Obsidian integration
#
# Setup Instructions:
# 1. Install Obsidian: https://obsidian.md/
# 2. Install the REST API plugin: https://github.com/coddingtonbear/obsidian-web
# 3. Configure the plugin to run on the port specified below
# 4. Get your REST API token from the plugin settings

# Obsidian REST API URL
# Default: http://localhost:27124
# Change if your Obsidian REST API runs on a different port
OBSIDIAN_REST_URL=http://localhost:27124

# Obsidian REST API Token
# Get this from your Obsidian REST API plugin settings
# Leave empty if you don't want to use Obsidian integration
OBSIDIAN_REST_TOKEN=


# -----------------------------------------------------------------------------
# Orchestrator Selection
# -----------------------------------------------------------------------------
# Choose between LangGraph (default) and LangChain orchestrators.
# Optional: Application defaults to LangGraph if not set.
#
# USE_LANGCHAIN_ORCHESTRATOR: Set to "true" to use LangChain orchestrator
# Default: false (uses LangGraph orchestrator)
# USE_LANGCHAIN_ORCHESTRATOR=false


# =============================================================================
# DEPLOYMENT SCENARIOS
# =============================================================================
#
# The configuration above assumes a self-hosted setup. Here are alternative
# configurations for different deployment scenarios:
#
# -----------------------------------------------------------------------------
# Scenario 1: Fully Self-Hosted (Default/Recommended)
# -----------------------------------------------------------------------------
# - PostgreSQL: Self-hosted via Docker (DATABASE_URL points to localhost:5432)
# - Mem0: Self-hosted via Docker (MEM0_HOST=http://localhost:8001)
# - Langfuse: Self-hosted via Docker (LANGFUSE_HOST=http://localhost:3000)
# - Obsidian: Local application (optional)
#
# This is the default configuration and requires:
#   docker-compose up -d
#
# -----------------------------------------------------------------------------
# Scenario 2: External Mem0
# -----------------------------------------------------------------------------
# If you prefer to use external Mem0 instead of self-hosted:
# 1. Comment out MEM0_HOST
# 2. Set MEM0_API_KEY to your external Mem0 API key
# 3. Get your key at: https://mem0.ai/
#
# -----------------------------------------------------------------------------
# Scenario 3: Production Deployment
# -----------------------------------------------------------------------------
# For production, you should:
# 1. Change all default passwords (DATABASE_URL, MEM0_API_KEY)
# 2. Use strong, unique API keys
# 3. Set up proper network security (firewall, VPN, etc.)
# 4. Use environment-specific values (dev/staging/prod)
# 5. Never commit .env file to version control
#
# -----------------------------------------------------------------------------
# Scenario 4: Development Without Optional Services
# -----------------------------------------------------------------------------
# For development, you can run without optional services:
# - Leave LANGFUSE_PUBLIC_KEY and LANGFUSE_SECRET_KEY empty
# - Leave OBSIDIAN_REST_TOKEN empty
# The application will run but without observability and Obsidian integration
#
# =============================================================================
# TROUBLESHOOTING
# =============================================================================
#
# If the application fails to start:
# 1. Check that all REQUIRED variables are set
# 2. Verify API keys are valid and not expired
# 3. Ensure Docker services are running: docker-compose ps
# 4. Check service logs: docker-compose logs [service-name]
# 5. Verify database connection: psql -h localhost -U ai_user -d ai_assistant
# 6. Test Mem0 health: curl http://localhost:8001/health
# 7. Test Langfuse health: curl http://localhost:3000/api/public/health
#
# Common Issues:
# - "OPENROUTER_API_KEY is required": Set a valid OpenRouter API key
# - "DATABASE_URL is required": Set the PostgreSQL connection string
# - "Either MEM0_HOST or MEM0_API_KEY is required": Set MEM0_HOST for self-hosted (recommended)
# - Langfuse ZodError: This is handled automatically by the application
#
# =============================================================================
